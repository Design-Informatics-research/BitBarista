
{% extends "index.html" %}
{% block content %}

<div class="row" id="offers">
  <div class="col-sm-offset-1 col-sm-10">
    <p><span class="input">Future Supply</span></p>
    <p>Best matches for coffee orders on <span class="input">16 Sep 2016</span><br/>
    The price you pay for your coffee will influence the next supply</p>
    Choose option
    <!-- <div id="led" style="height:20px; width:20px; background-color:red; border:1px solid gray; border-radius:15px;"></div>-->

    <div class="row">
      <div class="col-sm-5">
        <a class="touch-button" href="/sale/Vietnamese" style="">
          <span class="input">South Asian Blend Medium </span><br/>
          <span class="input_u">Macth: Best Price</span><br/>
          <!-- <img src="../assets/espresso.jpeg" style="height:8.9em; width:auto;"></img>-->
          Sign up to this future supply, pay <span class="input">{{ offers["Vietnamese"] }} BTC</span>
        </a>
      </div>

      <div class="col-sm-5">
        <a class="touch-button" href="/sale/Brazilian" style="">
          <span class="input">Brazil Santos Medium-Dark</span><br/>
          <span class="input_u">Match: Best Quality</span><br/>
          <!-- <img src="../assets/espresso.jpeg" style="height:8.9em; width:auto;"></img>-->
          Sign up to this future supply, pay <span class="input">{{ offers["Brazilian"] }} BTC</span>
        </a>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-5">
        <a class="touch-button" href="/sale/Ethiopian" style="">
          <span class="input">Ethiopia Sidamo Medium</span><br/>
          <span class="input_u">Match: Best Social Responsibility</span><br/>
          <!-- <img src="../assets/espresso.jpeg" style="height:8.9em; width:auto;"></img>-->
          Sign up to this future supply, pay <span class="input">{{ offers["Ethiopian"] }} BTC</span>
        </a>
      </div>

      <div class="col-sm-5">
        <a class="touch-button" href="/sale/Colombian" style="">
         <span class="input">Colombia Huila Medium</span><br/>
          <span class="input_u">Match: Low Environmental Impact</span><br/>
          <!-- <img src="../assets/espresso.jpeg" style="height:8.9em; width:auto;"></img>-->
          Sign up to this future supply, pay <span class="input">{{ offers["Colombian"] }} BTC</span>
        </a>
      </div>
    </div>

  </div>
</div>

<div class="row" id="issues">
  <div class="col-sm-offset-1 col-sm-10">
    <p>Oh, it looks like I could do with some help!</p>

    <div class="row">
      <div class="col-sm-5">
        <div class="touch-button" style="">
          <p id="issue-message"></p>
        </div>
      </div>

      <div class="col-sm-5">
        <a href="../help" class="touch-button" style="">
          <p>Check troubleshooting manual</p>
        </a>
      </div>
    </div>


  </div>
</div>

{% endblock %}

{% block javascript %}
<script>

$(document).ready(function(){
  //$('#issues').hide();

  var timeoot = 0;
  function poll() { 
    setTimeout(function() {
      $.ajax({ url: "{{ state_url }}",
        success: function(data) { 
          timeoot = 6000;
          
          $('#issue-message').html('');

          if (data.overall == 'ready') {
            $('#offers').show();
            $('#issues').hide();
          } else if (data.overall == 'water') {
            window.location.replace("http://localhost:5000/water_request/");
          } else {
            $('#issues').show();
            $('#offers').hide();
            $('#issue-message').append(data.message);
          }
        }, 
        dataType: "json",
        complete: poll
      });
    }, timeoot);
  }

  poll();
});
</script>
{% endblock %}
